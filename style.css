/* =========================================================
   AutoBGM — CLEAN style.css (dedup + stable responsive)
   ========================================================= */

/* ===== extension drawer wrapper ===== */
.abgm-wrap{
  padding:12px;
  border:1px solid rgba(255,255,255,.08);
  border-radius:12px;
  background:rgba(255,255,255,.03);
}

.abgm-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}

.abgm-toggle{
  display:flex;
  align-items:center;
  gap:8px;
  font-size:14px;
}

.abgm-btn{
  padding:6px 10px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.06);
  color:inherit;
}

.abgm-help{
  margin-top:10px;
  font-size:12px;
  opacity:.8;
}

/* ===== modal base ===== */
body.autobgm-modal-open{ overflow:hidden; }

.autobgm-overlay{
  position:fixed;
  inset:0;
  display:flex;
  align-items:flex-start;
  justify-content:center;
  overflow:auto;
  -webkit-overflow-scrolling: touch;
  background:rgba(0,0,0,.55);
  z-index:99999;
  padding:12px;
}

@supports (padding: max(0px, env(safe-area-inset-top))){
  .autobgm-overlay{
    padding-top: max(12px, env(safe-area-inset-top));
    padding-right: max(12px, env(safe-area-inset-right));
    padding-bottom: max(12px, env(safe-area-inset-bottom));
    padding-left: max(12px, env(safe-area-inset-left));
  }
}

/* JS가 width/height를 !important로 박아주지만, fallback로 남겨둠 */
.autobgm-modal{
  width:min(900px, 96vw);
  max-height: calc(100vh - 24px);
  min-height: 240px;
  overflow:auto;
  box-sizing:border-box;
  border:1px solid rgba(255,255,255,.14);
  border-radius:14px;
  background:rgba(20,20,20,.96);
  box-shadow:0 10px 40px rgba(0,0,0,.55);
}

.autobgm-modal-h{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding:12px 14px;
  border-bottom:1px solid rgba(255,255,255,.10);
}

.autobgm-modal-b{ padding:12px 14px 14px; }

/* ===== modal ui ===== */
.abgm-topbar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  flex-wrap:wrap;
}

.abgm-grid{
  display:grid;
  grid-template-columns: 1fr;
  gap:12px;
}

.abgm-card{
  border:1px solid rgba(255,255,255,.10);
  border-radius:14px;
  background:rgba(255,255,255,.03);
  padding:12px;
  min-width:0;
}

.abgm-card-h{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  margin-bottom:10px;
}

.abgm-row,
.abgm-inline{
  display:flex;
  align-items:center;
  gap:8px;
  min-width:0;
}

.abgm-select{
  width:100%;
  padding:6px 10px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.06);
  color:inherit;
  min-width:0;
}

.abgm-select-slim{
  width:auto;
  min-width:200px;
}

.abgm-range{ width:180px; }

.abgm-hr{
  margin:12px 0;
  opacity:.18;
}

.abgm-minihelp{
  margin-top:10px;
  font-size:12px;
  opacity:.75;
  line-height:1.35;
}

/* inputs in modal should not overflow */
.autobgm-modal input,
.autobgm-modal select,
.autobgm-modal .text_pole{
  min-width:0;
  max-width:100%;
}

/* ===== table ===== */
.abgm-tablewrap{
  margin-top:10px;
  border:1px solid rgba(255,255,255,.10);
  border-radius:12px;
  overflow:auto;
  -webkit-overflow-scrolling: touch;
}

.abgm-table{
  width:100%;
  border-collapse:collapse;
  font-size:13px;
  table-layout: fixed; /* 핵심: 모바일에서 우측 버튼 밀림 방지 */
  min-width:0;
}

.abgm-table thead{ background:rgba(255,255,255,.05); }

.abgm-table th, .abgm-table td{
  padding:8px 10px;
  border-bottom:1px solid rgba(255,255,255,.08);
  vertical-align:middle;
}

.abgm-col-check{
  width:38px;
  text-align:center;
  padding:8px 6px !important;
}

.abgm-table input.abgm_sel{ transform:scale(1.05); }

.abgm-table input[type="text"],
.abgm-table input[type="number"]{
  width:100%;
  padding:6px 8px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.06);
  color:inherit;
}

.abgm-iconbtn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:34px;
  height:30px;
}

/* column widths: (1)check / (2)file / (3)play / (4)more */
.abgm-table th:nth-child(1),
.abgm-table td:nth-child(1){ width:44px; }

.abgm-table th:nth-child(3),
.abgm-table td:nth-child(3){ width:72px; }

.abgm-table th:nth-child(4),
.abgm-table td:nth-child(4){ width:64px; }

.abgm-filecell{
  min-width:0;
  overflow:hidden;
}

.abgm_name{
  width:100%;
  min-width:0;
  max-width:100%;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}

/* ===== row: collapsed / expanded ===== */
.abgm-bgm-summary.abgm-expanded td{
  background: rgba(255,255,255,.02);
}

.abgm_toggle i{ transition: transform .15s ease; }
.abgm-bgm-summary.abgm-expanded .abgm_toggle i{ transform: rotate(180deg); }

/* ===== detail row ===== */
.abgm-bgm-detail td{
  padding: 10px 10px 12px;
  background: rgba(255,255,255,.03);
}

/* detail layout (base) */
.abgm-detail-grid{
  display:grid;
  grid-template-columns: 1fr 170px 130px;
  gap:10px;
  align-items: stretch;
}

.abgm-keywords{
  display:flex;
  flex-direction:column;
  min-width:0;
}

.abgm-keywords textarea.abgm_keywords{
  width:100%;
  min-height: 74px;      /* 기본 높이(모바일에서 더 줄일거면 media에서) */
  max-height: 180px;
  resize: vertical;
  padding: 8px 10px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: inherit;
}

.abgm-side{
  display:flex;
  flex-direction:column;
  gap:10px;
  height:100%;
  justify-content: space-between;
  padding-top: 14px;
  padding-bottom: 10px;
}

.abgm-field-tight small{ opacity:.8; }

.abgm_narrow{ max-width: 120px; }

.abgm-volcell{
  display:flex;
  align-items:center;
  gap:8px;
  min-width:0;
}

.abgm-volcell .abgm_vol{ width:100%; min-width:0; }
.abgm-volcell .abgm_volnum{ width:72px; text-align:right; }

.abgm_vol_lock{ padding:6px 8px; }
.abgm_vol_lock i{ opacity:.85; }
.abgm_vol:disabled{ opacity:.45; cursor:not-allowed; }

.abgm-detail-actions{
  height:100%;
  display:flex;
  gap:8px;
  align-items:center;
  justify-content:flex-end; /* 기본은 우측 */
  min-width:140px;
}

/* mobile: delete label 숨김(있을 경우) */
@media (max-width: 520px){
  .abgm-del-label{ display:none; }
}

/* ===== responsive: mobile table widths (play/more 항상 보이게) ===== */
@media (max-width: 520px){
  .abgm-table th, .abgm-table td{ padding:6px 6px; }
  .abgm-iconbtn{ width:30px; height:28px; }

  .abgm-table th:nth-child(1),
  .abgm-table td:nth-child(1){ width:38px; }

  .abgm-table th:nth-child(3),
  .abgm-table td:nth-child(3){ width:58px; }

  .abgm-table th:nth-child(4),
  .abgm-table td:nth-child(4){ width:58px; }

  /* filecell은 “너무 길어서 버튼 밀기” 방지: 60% 기준 */
  .abgm-filecell{ width:60%; }
}

/* ===== responsive: mobile detail (2col + 2row) + compact volume wrap ===== */
@media (max-width: 520px){
  .abgm-bgm-detail td{ padding: 8px 8px 10px; }

  .abgm-detail-grid{
    grid-template-columns: minmax(0, 1fr) 150px;
    grid-template-areas:
      "kw side"
      "kw act";
    gap:8px;
    align-items: stretch;
  }

  .abgm-keywords{ grid-area: kw; }
  .abgm-side{ grid-area: side; }
  .abgm-detail-actions{
    grid-area: act;
    align-self: center;
    justify-self: end;
    padding-right: 10px;
    padding-bottom: 6px;
  }

  /* 키워드 높이 조금만(너가 OK라 했던 값) */
  .abgm-keywords textarea.abgm_keywords{
    min-height: 74px;
    max-height: 130px;
  }

  /* 우측 스택 */
  .abgm-side{
    padding-top: 10px;
    padding-bottom: 8px;
    justify-content: flex-start;
    gap:10px;
  }

  /* 볼륨: 슬라이더는 한 줄로 길게, 숫자/락은 아래 우측 */
  .abgm-volcell{
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    gap:8px;
  }

  .abgm-volcell .abgm_vol{
    flex: 1 0 100%;
    width: 100%;
    min-width:0;
    margin-top:2px;
  }

  .abgm-volcell .abgm_volnum{
    width:72px;
    margin-left:auto;
  }

  .abgm-volcell .abgm_vol_lock{
    width:34px;
    height:30px;
  }
}

/* super narrow: detail 1col */
@media (max-width: 380px){
  .abgm-detail-grid{
    grid-template-columns: 1fr;
    grid-template-areas:
      "kw"
      "side"
      "act";
  }
  .abgm-detail-actions{
    justify-self: start;
    padding-right: 0;
  }
}

/* ===== desktop: detail layout FINAL (fixed slider width) ===== */
@media (min-width: 900px){
  .abgm-detail-grid{
    grid-template-columns: minmax(260px, 1fr) 180px 180px;
    grid-template-areas:
      "kw pr del"
      "kw vol vol";
    align-items: start;
  }

  .abgm-keywords{ grid-area: kw; }

  .abgm-side{ display: contents; }

  .abgm-side > .abgm-field-tight:nth-child(1){
    grid-area: pr;
    align-self: start;
  }

  .abgm-side > .abgm-field-tight:nth-child(2){
    grid-area: vol;
    align-self: start;
    justify-self: end;
    max-width: 340px; /* vol block limit */
  }

  .abgm-detail-actions{
    grid-area: del;
    height:auto;
    align-self:start;
    justify-self:end;
    justify-content:flex-end;
    padding-right: 14px; /* PC에서 너무 끝으로 안 붙게 */
    padding-top: 6px;
  }

  /* slider length fixed */
  .abgm-volcell{
    display:grid;
    grid-template-columns: 180px 72px 34px;
    gap:8px;
    align-items:center;
    justify-content:end;
  }

  .abgm-volcell .abgm_vol{
    width:180px;
    min-width:0;
  }
}

/* ===== confirm modal ===== */
.abgm-confirm-wrap{
  position: fixed;
  inset: 0;
  z-index: 2147483647;
  display: grid;
  place-items: center;
}

.abgm-confirm-backdrop{
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,.55);
}

.abgm-confirm{
  position: relative;
  width: min(420px, calc(100vw - 24px));
  border: 1px solid rgba(255,255,255,.14);
  border-radius: 14px;
  background: rgba(20,20,20,.96);
  box-shadow: 0 10px 40px rgba(0,0,0,.55);
  padding: 12px 14px;
}

.abgm-confirm-title{ font-weight: 700; margin-bottom: 8px; }
.abgm-confirm-msg{ opacity: .9; white-space: pre-wrap; line-height: 1.35; }

.abgm-confirm-actions{
  display:flex;
  justify-content:flex-end;
  gap:8px;
  margin-top:12px;
}

/* confirm이 overlay(모달) 안에 붙을 때: overlay 기준 중앙 */
.abgm-confirm-wrap.abgm-confirm-in-modal{
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
}

/* =========================
   PC slider hard cap (final override)
   ========================= */
@media (min-width: 700px){
  /* 슬라이더 길이 고정(원하는 값으로 숫자만 바꾸면 됨) */
  .abgm-volcell{
    grid-template-columns: 160px 72px 34px !important; /* <- 160이 슬라이더 길이 */
    justify-content: end !important;
  }

  input[type="range"].abgm_vol{
    width: 160px !important;
    max-width: 160px !important;
    min-width: 0 !important;
    flex: 0 0 160px !important;
  }
}
